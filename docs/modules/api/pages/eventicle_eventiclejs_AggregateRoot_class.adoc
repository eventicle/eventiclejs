= class AggregateRoot

Base class for implementing event-sourced aggregate roots.

Aggregate roots are the core building blocks of domain-driven design and event sourcing. They encapsulate business logic, maintain consistency boundaries, and generate events that represent state changes. The aggregate's current state is rebuilt by replaying its historical events through reducer functions.

Key Features: - \*\*Event Sourcing\*\*: State is derived from events, not stored directly - \*\*Business Logic\*\*: Encapsulates domain rules and invariants - \*\*Event Generation\*\*: Emits events when state changes occur - \*\*Immutable History\*\*: Complete audit trail of all changes - \*\*Checkpointing\*\*: Optional performance optimization for large event histories



== Properties

[id="eventicle_eventiclejs_AggregateRoot_config_member"]
=== config

========

Aggregate configuration settings




.Signature
[source,typescript]
----
readonly config: AggregateConfig;
----

========
[id="eventicle_eventiclejs_AggregateRoot_history_member"]
=== history

========

Complete event history for this aggregate instance




.Signature
[source,typescript]
----
history: EventicleEvent[];
----

========
[id="eventicle_eventiclejs_AggregateRoot_id_member"]
=== id

========

Unique identifier for this aggregate instance




.Signature
[source,typescript]
----
id: string;
----

========
[id="eventicle_eventiclejs_AggregateRoot_newEvents_member"]
=== newEvents

========

Events raised since last persistence (pending events)




.Signature
[source,typescript]
----
newEvents: EventicleEvent[];
----

========
[id="eventicle_eventiclejs_AggregateRoot_reducers_member"]
=== reducers

========

Event reducer functions mapping event types to state update logic




.Signature
[source,typescript]
----
reducers: any;
----

========
[id="eventicle_eventiclejs_AggregateRoot_replaying_member"]
=== replaying

========

Flag indicating if aggregate is currently replaying historical events




.Signature
[source,typescript]
----
replaying: boolean;
----

========
[id="eventicle_eventiclejs_AggregateRoot_type_member"]
=== type

========






.Signature
[source,typescript]
----
get type(): string;
----

========

== Constructors

[id="eventicle_eventiclejs_AggregateRoot_constructor_1"]
=== (constructor)(type)

========

Constructs a new instance of the `AggregateRoot` class



.Parameters
[%header,cols="2,3,4",caption=""]
|===
|Name |Type |Description

m|type
m|string \| ~AggregateConfig
|
|===

.Signature
[source,typescript]
----
constructor(type: string | AggregateConfig);
----

========

== Methods

[id="eventicle_eventiclejs_AggregateRoot_currentCheckpoint_member_1"]
=== currentCheckpoint()

========

Returns the current state as a checkpoint for performance optimization.

Checkpoints allow aggregates with long event histories to snapshot their current state, reducing the time needed to rebuild from events. This method should be implemented when `storeCheckpoint` is enabled in the config.




.Signature
[source,typescript]
----
currentCheckpoint(): object;
----

========
[id="eventicle_eventiclejs_AggregateRoot_handleEvent_member_1"]
=== handleEvent(event)

========

Applies an event to the aggregate state using the appropriate reducer.

This method is called automatically by `raiseEvent` and during event replay. It looks up the reducer function for the event type and applies the event to update the aggregate's state.



.Parameters
[%header%footer,cols="2,3,4",caption=""]
|===
|Name |Type |Description

m|event
m|xref:eventicle_eventiclejs_EventicleEvent_interface.adoc[EventicleEvent]
|The event to apply to the aggregate state

s|Returns
m|void
|
|===

.Signature
[source,typescript]
----
handleEvent(event: EventicleEvent): void;
----

========
[id="eventicle_eventiclejs_AggregateRoot_raiseEvent_member_1"]
=== raiseEvent(event)

========

Raises a new domain event and applies it to the aggregate state.

This is the primary method for recording state changes in event-sourced aggregates. The event is automatically assigned metadata (ID, timestamp, source) and applied through the appropriate reducer function.



.Parameters
[%header%footer,cols="2,3,4",caption=""]
|===
|Name |Type |Description

m|event
m|xref:eventicle_eventiclejs_EventicleEvent_interface.adoc[EventicleEvent]
|The domain event to raise

s|Returns
m|xref:eventicle_eventiclejs_EventicleEvent_interface.adoc[EventicleEvent]&lt;any&gt;
|The event with populated metadata
|===

.Signature
[source,typescript]
----
raiseEvent(event: EventicleEvent): EventicleEvent<any>;
----

========
